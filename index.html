<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="NOT10 - Multiplayer Card & Betting Game">
    <meta name="theme-color" content="#0a0e1a">
    <title>NOT10 - Card Game</title>
    <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body>
    <!-- App Container -->
    <div id="app">
        <!-- Loading Screen -->
        <div id="loading-screen" class="screen">
            <div class="loading-content">
                <h1 class="game-title">NOT10</h1>
                <div class="loading-spinner"></div>
                <p class="loading-text">Initializing...</p>
            </div>
        </div>

        <!-- Setup Required Screen -->
        <div id="setup-screen" class="screen hidden">
            <div class="setup-content">
                <h1 class="game-title">NOT10</h1>
                <div class="setup-message">
                    <h2>‚öôÔ∏è Setup Required</h2>
                    <p>Supabase configuration not found.</p>
                    <ol>
                        <li>Copy <code>assets/js/config.example.js</code> to <code>assets/js/config.js</code></li>
                        <li>Add your Supabase URL and Anon Key</li>
                        <li>Refresh the page</li>
                    </ol>
                    <p class="note">See README.md for detailed setup instructions.</p>
                    <button id="play-offline-btn" class="btn btn-primary">Play Offline (AI Mode)</button>
                </div>
            </div>
        </div>

        <!-- Main Menu Screen -->
        <div id="menu-screen" class="screen hidden">
            <div class="menu-content">
                <h1 class="game-title glow">NOT10</h1>
                <p class="game-subtitle">Bet Smart. Play Smart. Don't Hit 10.</p>
                
                <div class="menu-buttons">
                    <button id="create-lobby-btn" class="btn btn-primary btn-large">
                        <span class="btn-icon">üéÆ</span>
                        Create Lobby
                    </button>
                    <button id="join-lobby-btn" class="btn btn-primary btn-large">
                        <span class="btn-icon">üö™</span>
                        Join Lobby
                    </button>
                    <button id="play-ai-btn" class="btn btn-secondary btn-large">
                        <span class="btn-icon">ü§ñ</span>
                        Play vs AI
                    </button>
                </div>

                <div class="menu-footer">
                    <button id="help-btn" class="btn-text">How to Play</button>
                </div>
            </div>
        </div>

        <!-- Create Lobby Screen -->
        <div id="create-screen" class="screen hidden">
            <div class="lobby-content">
                <h2 class="screen-title">Create Lobby</h2>
                
                <div class="room-info">
                    <div class="room-code-display">
                        <label>Room Code</label>
                        <div class="code-box">
                            <span id="room-code-text">------</span>
                            <button id="copy-code-btn" class="btn-icon-small" title="Copy code">üìã</button>
                        </div>
                    </div>
                    
                    <div class="player-name-input">
                        <label for="create-player-name">Your Name</label>
                        <input type="text" id="create-player-name" maxlength="20" placeholder="Enter your name">
                    </div>
                </div>

                <div class="seats-container">
                    <h3>Players (Max 4)</h3>
                    <div id="create-seats-list" class="seats-list">
                        <!-- Dynamically populated -->
                    </div>
                </div>

                <div class="lobby-actions">
                    <button id="ready-btn" class="btn btn-primary" disabled>Ready</button>
                    <button id="start-game-btn" class="btn btn-success hidden" disabled>Start Game</button>
                    <button id="leave-create-btn" class="btn btn-danger">Leave Lobby</button>
                </div>
            </div>
        </div>

        <!-- Join Lobby Screen -->
        <div id="join-screen" class="screen hidden">
            <div class="join-content">
                <h2 class="screen-title">Join Lobby</h2>
                
                <div class="join-form">
                    <div class="form-group">
                        <label for="join-room-code">Room Code</label>
                        <input type="text" id="join-room-code" maxlength="6" placeholder="ABC123" style="text-transform: uppercase;">
                    </div>
                    
                    <div class="form-group">
                        <label for="join-player-name">Your Name</label>
                        <input type="text" id="join-player-name" maxlength="20" placeholder="Enter your name">
                    </div>

                    <button id="join-room-btn" class="btn btn-primary btn-large">Join Room</button>
                    <button id="back-from-join-btn" class="btn btn-secondary">Back to Menu</button>
                    
                    <div id="join-error" class="error-message hidden"></div>
                </div>
            </div>
        </div>

        <!-- Lobby Screen (after joining) -->
        <div id="lobby-screen" class="screen hidden">
            <div class="lobby-content">
                <h2 class="screen-title">Lobby</h2>
                
                <div class="room-info">
                    <div class="room-code-display">
                        <label>Room Code</label>
                        <div class="code-box">
                            <span id="lobby-room-code">------</span>
                            <button id="copy-lobby-code-btn" class="btn-icon-small" title="Copy code">üìã</button>
                        </div>
                    </div>
                </div>

                <div class="seats-container">
                    <h3>Players</h3>
                    <div id="lobby-seats-list" class="seats-list">
                        <!-- Dynamically populated -->
                    </div>
                </div>

                <div class="lobby-actions">
                    <button id="lobby-ready-btn" class="btn btn-primary">Ready</button>
                    <button id="host-start-btn" class="btn btn-success hidden" disabled>Start Game</button>
                    <button id="leave-lobby-btn" class="btn btn-danger">Leave Lobby</button>
                </div>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="game-screen" class="screen hidden">
            <div class="game-layout">
                <!-- Game Header -->
                <div class="game-header">
                    <div class="header-left">
                        <span id="round-number">Round 1</span>
                    </div>
                    <div class="header-center">
                        <div class="pot-display">
                            <span class="pot-label">POT</span>
                            <span id="pot-amount" class="pot-amount">$0</span>
                        </div>
                    </div>
                    <div class="header-right">
                        <button id="leave-game-btn" class="btn-small btn-danger">Leave</button>
                    </div>
                </div>

                <!-- Table Area -->
                <div class="game-table">
                    <!-- Central Total Display -->
                    <div class="table-center">
                        <div class="total-display">
                            <span class="total-label">TABLE</span>
                            <span id="table-total" class="total-value">0</span>
                        </div>
                        <div id="phase-indicator" class="phase-indicator">Dealing...</div>
                    </div>

                    <!-- Player Panels (4 positions) -->
                    <div id="player-0" class="player-panel pos-0">
                        <div class="player-info">
                            <div class="player-name">Empty</div>
                            <div class="player-money">$0</div>
                            <div class="player-bet">Bet: $0</div>
                            <div class="player-status"></div>
                        </div>
                        <div class="played-card-display" id="played-card-0"></div>
                    </div>

                    <div id="player-1" class="player-panel pos-1">
                        <div class="player-info">
                            <div class="player-name">Empty</div>
                            <div class="player-money">$0</div>
                            <div class="player-bet">Bet: $0</div>
                            <div class="player-status"></div>
                        </div>
                        <div class="played-card-display" id="played-card-1"></div>
                    </div>

                    <div id="player-2" class="player-panel pos-2">
                        <div class="player-info">
                            <div class="player-name">Empty</div>
                            <div class="player-money">$0</div>
                            <div class="player-bet">Bet: $0</div>
                            <div class="player-status"></div>
                        </div>
                        <div class="played-card-display" id="played-card-2"></div>
                    </div>

                    <div id="player-3" class="player-panel pos-3">
                        <div class="player-info">
                            <div class="player-name">Empty</div>
                            <div class="player-money">$0</div>
                            <div class="player-bet">Bet: $0</div>
                            <div class="player-status"></div>
                        </div>
                        <div class="played-card-display" id="played-card-3"></div>
                    </div>
                </div>

                <!-- Player Hand & Controls -->
                <div class="player-controls">
                    <div class="controls-and-cards">
                        <div class="controls-column">
                            <div id="betting-controls" class="controls-section hidden">
                                <div class="controls-header">
                                    <h3>Betting</h3>
                                    <p id="betting-instruction" class="instruction-text"></p>
                                    <div class="bet-info">
                                        <span id="table-highest">Table: $0</span>
                                        <span id="your-bet">You: $0</span>
                                        <span id="call-amount">To Call: $0</span>
                                    </div>
                                </div>
                                <div class="betting-buttons">
                                    <button class="btn btn-bet" data-amount="100">BET +$100</button>
                                    <button class="btn btn-bet" data-amount="200">BET +$200</button>
                                    <button class="btn btn-bet" data-amount="500">BET +$500</button>
                                    <button id="all-in-btn" class="btn btn-all-in">ALL-IN</button>
                                    <button id="finalize-btn" class="btn btn-finalize">FINALIZE</button>
                                    <button id="call-btn" class="btn btn-call">CALL</button>
                                </div>
                            </div>

                            <div id="playing-controls" class="controls-section hidden">
                                <div class="controls-header">
                                    <h3>Your Hand</h3>
                                    <p id="playing-instruction" class="instruction-text"></p>
                                </div>
                            </div>

                            <div id="spectator-notice" class="controls-section hidden">
                                <div class="spectator-message">
                                    <h3>üëª Spectating</h3>
                                    <p>You're out of money. Watch the remaining players battle it out!</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="cards-column">
                            <div id="hand-cards" class="hand-cards">
                                <!-- Dynamically populated with cards -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Event Log -->
                <div class="event-log">
                    <div class="log-header">
                        <h3>Game Log</h3>
                        <button id="clear-log-btn" class="btn-text">Clear</button>
                    </div>
                    <div id="log-messages" class="log-messages">
                        <!-- Dynamically populated -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Game Over Screen -->
        <div id="gameover-screen" class="screen hidden">
            <div class="gameover-content">
                <h1 class="game-title glow">Game Over</h1>
                <div class="winner-display">
                    <div class="trophy">üèÜ</div>
                    <h2 id="winner-name" class="winner-name">Player Name</h2>
                    <p class="winner-subtitle">wins with <span id="winner-amount">$0</span>!</p>
                </div>
                
                <div class="final-standings">
                    <h3>Final Standings</h3>
                    <div id="standings-list" class="standings-list">
                        <!-- Dynamically populated -->
                    </div>
                </div>

                <div class="gameover-actions">
                    <button id="play-again-btn" class="btn btn-primary btn-large">Play Again</button>
                    <button id="back-to-menu-btn" class="btn btn-secondary">Back to Menu</button>
                </div>
            </div>
        </div>

        <!-- Help Modal -->
        <div id="help-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>How to Play NOT10</h2>
                    <button id="close-help-btn" class="btn-close">√ó</button>
                </div>
                <div class="modal-body">
                    <h3>Objective</h3>
                    <p>Be the last player with money. Avoid being the one to push the table total to 10 or higher.</p>
                    
                    <h3>Setup</h3>
                    <ul>
                        <li>2-4 players start with $1,000 each</li>
                        <li>40-card deck: 10 cards each of values 0, 1, 2, 3</li>
                        <li>Each round, players receive 4 cards (6 if only 2 players remain)</li>
                    </ul>
                    
                    <h3>Betting Rules</h3>
                    <ul>
                        <li>Betting is <strong>mandatory</strong> - no checking or folding</li>
                        <li>You must raise at least once per betting phase</li>
                        <li>Raise amounts: $100, $200, or $500 only</li>
                        <li>After raising once, you can raise more or call</li>
                        <li>Betting ends when all players have called</li>
                    </ul>
                    
                    <h3>Playing Cards</h3>
                    <ul>
                        <li>Players take turns playing one card</li>
                        <li>Table total increases by the card's value</li>
                        <li>If total reaches 10+ after <strong>your</strong> card, you're eliminated from the round</li>
                        <li>Only one elimination per round</li>
                    </ul>
                    
                    <h3>Winning & Losing</h3>
                    <ul>
                        <li>Eliminated player gets $0 from the pot</li>
                        <li>Survivors split the pot equally</li>
                        <li>If your money reaches $0, you become a spectator</li>
                        <li>Game ends when one player has all the money</li>
                    </ul>
                    
                    <h3>Strategy Tips</h3>
                    <ul>
                        <li>Save low cards (0, 1) for when the total is high</li>
                        <li>Bluff with big raises even with risky cards</li>
                        <li>Watch opponents' betting patterns</li>
                        <li>Calculate pot odds before making large raises</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Import JavaScript Modules -->
    <script type="module" src="assets/js/app.js"></script>
</body>
</html>
